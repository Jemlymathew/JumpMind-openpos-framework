<?xml version="1.0"?>
<!DOCTYPE database SYSTEM "http://db.apache.org/torque/dtd/database">
<database name="openpos">

<?xml version="1.0"?>
<!--

    Licensed to JumpMind Inc under one or more contributor
    license agreements.  See the NOTICE file distributed
    with this work for additional information regarding
    copyright ownership.  JumpMind Inc licenses this file
    to you under the GNU General Public License, version 3.0 (GPLv3)
    (the "License"); you may not use this file except in compliance
    with the License.

    You should have received a copy of the GNU General Public License,
    version 3.0 (GPLv3) along with this library; if not, see
    <http://www.gnu.org/licenses/>.

    Unless required by applicable law or agreed to in writing,
    software distributed under the License is distributed on an
    "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, either express or implied.  See the License for the
    specific language governing permissions and limitations
    under the License.

-->
<!DOCTYPE database SYSTEM "database.dtd">
<database name="openpos">
    <!-- Access Control -->
    <table name="operator" description="Security Identifier granting and denying access to the systems of the retail enterprise, and recorded upon the transaction originating from those systems.">
        <column name="id" type="VARCHAR" size="16" required="true" primaryKey="true" description="A unique, automatically assigned key used to identify an operator." />
        <column name="user_name" type="VARCHAR" size="50" description="The short human readable name used as an alternate ID for Operator. " />
        <column name="password" type="VARCHAR" size="64" description="A hashed security password entered by an operator and used to verify his/her identity when signing on to a Workstation." />
        <column name="create_time" type="TIMESTAMP" description="Timestamp when this entry was created." />
        <column name="create_by" type="VARCHAR" size="50" description="The user who last updated this entry." />
        <column name="last_update_by" type="VARCHAR" size="50" description="The user who created this entry." />
        <column name="last_update_time" type="TIMESTAMP" description="Timestamp when a user last updated this entry." />
    </table>
    <table name="security_question" description="A question that is put ot the Customer or Operator when they have forgotten their Password and the system is trying to verify their identity.">
        <column name="id" type="VARCHAR" size="16" required="true" primaryKey="true" description="A unique, automatically assigned key used to identify a security question." />
        <column name="question" type="VARCHAR" size="255" description="A question that is put to a Customer or Operator when they have forgotten their Password and the system is trying to verify their identity and allow a new Password to be set" />
        <column name="create_time" type="TIMESTAMP" description="Timestamp when this entry was created." />
        <column name="create_by" type="VARCHAR" size="50" description="The user who last updated this entry." />
        <column name="last_update_by" type="VARCHAR" size="50" description="The user who created this entry." />
        <column name="last_update_time" type="TIMESTAMP" description="Timestamp when a user last updated this entry." />
    </table>
    <table name="operator_security_question" description="A record of the Operator's answer to a security question that is put to the Operator when they have forgotten their Password and the system is trying to verify their identity and allow a new Password to be set">
        <column name="operator_id" type="VARCHAR" size="16" required="true" primaryKey="true" description="The corresponding Operator id." />
        <column name="security_question_id" type="VARCHAR" size="16" required="true" primaryKey="true" description="The corresponding SecurityQuestion id." />
        <column name="answer" type="VARCHAR" size="255" description="A record of the Operator's answer to the indicated SecurityQuestion." />
        <column name="effective_time" type="TIMESTAMP" description="The date and time at which this OperatorSecurityHint was chosen by the Operator." />
        <column name="expiration_time" type="TIMESTAMP" description="The date and time at which this OperatorSecurityHint ceases to be valie because a new SecurityHint has been chosen." />
        <column name="create_time" type="TIMESTAMP" description="Timestamp when this entry was created." />
        <column name="create_by" type="VARCHAR" size="50" description="The user who last updated this entry." />
        <column name="last_update_by" type="VARCHAR" size="50" description="The user who created this entry." />
        <column name="last_update_time" type="TIMESTAMP" description="Timestamp when a user last updated this entry." />
        <foreign-key foreignTable="operator" name="fk_opr_scr_ques_2_opr">
            <reference local="operator_id" foreign="id" />
        </foreign-key>    
        <foreign-key foreignTable="security_question" name="fk_opr_scr_ques_2_scr_ques">
            <reference local="security_question_id" foreign="id" />
        </foreign-key>                
    </table>
    <table name="password_history" description="A history of secret terms which are used to authenticate an Operator identification and thereby permits the Operator to access specific Resources and Workstation within the enterprise.">
        <column name="id" type="VARCHAR" size="16" required="true" primaryKey="true" description="A unique, automatically assigned key used to identify eacg successive password chosen by the Operator." />
        <column name="operator_id" type="VARCHAR" size="16" required="true" description="The corresponding Operator id." />
        <column name="password" type="VARCHAR" size="64" description="The password which permits the Operator to access specific Resources and Workstation within the enterprise." />
        <column name="expiration_time" type="TIMESTAMP" description="The date and time afterwhich this password can no longer be used to sign on." />
        <column name="create_time" type="TIMESTAMP" description="Timestamp when this entry was created." />
        <column name="create_by" type="VARCHAR" size="50" description="The user who last updated this entry." />
        <column name="last_update_by" type="VARCHAR" size="50" description="The user who created this entry." />
        <column name="last_update_time" type="TIMESTAMP" description="Timestamp when a user last updated this entry." />
        <foreign-key foreignTable="operator_id" name="fk_pwd_hst_2_opr">
            <reference local="operator_id" foreign="id" />
        </foreign-key>            
    </table>
    <table name="workgroup" description="A group within a workforce that normally works together and has similar access control permissions.">
        <column name="id" type="VARCHAR" size="16" required="true" primaryKey="true" description="A unique, automatically assigned key used to identify a Workgroup." />
        <column name="parent_workgroup_id" type="VARCHAR" SIZE="16" required="false" description="The Workgroup id that is the parent of this Workkgroup.  Used for hierarchical workgroups with casscading permissions." />        
        <column name="description" type="VARCHAR" SIZE="255" required="true" description="A description for the Workgroup." />
        <column name="create_time" type="TIMESTAMP" description="Timestamp when this entry was created." />
        <column name="create_by" type="VARCHAR" size="50" description="The user who last updated this entry." />
        <column name="last_update_by" type="VARCHAR" size="50" description="The user who created this entry." />
        <column name="last_update_time" type="TIMESTAMP" description="Timestamp when a user last updated this entry." />
        <!--  didn't include the foreign key to itself here for simplicity in initial loading, etc.  -->
    </table>
    <table name="operator_workgroup" description="A many to many table that associates operators with respective workgroups.">
        <column name="operator_id" type="VARCHAR" size="16" required="true" primaryKey="true" description="The corresponding Operator id." />
        <column name="workgroup_id" type="VARCHAR" size="16" required="true" primaryKey="true" description="The corresponding Workgroup id." />
        <column name="create_time" type="TIMESTAMP" description="Timestamp when this entry was created." />
        <column name="create_by" type="VARCHAR" size="50" description="The user who last updated this entry." />
        <column name="last_update_by" type="VARCHAR" size="50" description="The user who created this entry." />
        <column name="last_update_time" type="TIMESTAMP" description="Timestamp when a user last updated this entry." />
        <foreign-key foreignTable="operator" name="fk_opr_wrkgrp_2_opr">
            <reference local="operator_id" foreign="id" />
        </foreign-key>    
        <foreign-key foreignTable="workgroup" name="fk_opr_wrkgrp_2_wrkgrp">
            <reference local="workgroup_id" foreign="id" />
        </foreign-key>                
    </table>
    <table name="resource" description="An application, function, screen and/or field avaialbe for Workgroup access permissions.">
        <column name="id" type="VARCHAR" size="16" required="true" primaryKey="true" description="A unique, automatically assigned key used to identify a Resource." />
        <column name="parent_resource_id" type="VARCHAR" SIZE="16" required="false" description="The Resource id that is the parent of this Resource.  Used for hierarchical workgroups with casscading permissions." />        
        <column name="description" type="VARCHAR" SIZE="255" required="true" description="A description for the resource." />
        <column name="create_time" type="TIMESTAMP" description="Timestamp when this entry was created." />
        <column name="create_by" type="VARCHAR" size="50" description="The user who last updated this entry." />
        <column name="last_update_by" type="VARCHAR" size="50" description="The user who created this entry." />
        <column name="last_update_time" type="TIMESTAMP" description="Timestamp when a user last updated this entry." />
        <!--  didn't include the foreign key to itself here for simplicity in initial loading, etc.  -->
    </table>    
    <table name="workgroup_resource_access" description="A table that associates workgroups with resources and specifies their access level.">
        <column name="workgroup_id" type="VARCHAR" size="16" required="true" primaryKey="true" description="The corresponding Workgroup id." />
        <column name="resource_id" type="VARCHAR" size="16" required="true" primaryKey="true" description="The corresponding Resource id." />
        <column name="access_permissions" type="VARCHAR" size="5" required="true" description="The access permissions for the Workgroup to the Resource. Linux style permissions string with some additional attributes Read/Write/Delete/Admin/Execute (RWDAX)." />
        <column name="create_time" type="TIMESTAMP" description="Timestamp when this entry was created." />
        <column name="create_by" type="VARCHAR" size="50" description="The user who last updated this entry." />
        <column name="last_update_by" type="VARCHAR" size="50" description="The user who created this entry." />
        <column name="last_update_time" type="TIMESTAMP" description="Timestamp when a user last updated this entry." />
        <foreign-key foreignTable="resource" name="fk_wrkgrp_rsrc_accss_2_rsrc">
            <reference local="resource_id" foreign="id" />
        </foreign-key>    
        <foreign-key foreignTable="workgroup" name="fk_wrkgrp_rsrc_accss_2_wrkgrp">
            <reference local="workgroup_id" foreign="id" />
        </foreign-key>                
    </table>
    <!-- Place -->   
    <table name="brand" description="A type pf product sold withhin a Retail Store.">
        <column name="id" type="VARCHAR" size="16" required="true" primaryKey="true" description="A unique key used to identify a Brand" />
        <column name="abbreviation" type="VARCHAR" size="50" description="The abbreviation for the Brand."
        <column name="name" type="VARCHAR" size="255" description="The name of the Brand."
        <column name="create_time" type="TIMESTAMP" description="Timestamp when this entry was created." />
        <column name="create_by" type="VARCHAR" size="50" description="The user who last updated this entry." />
        <column name="last_update_by" type="VARCHAR" size="50" description="The user who created this entry." />
        <column name="last_update_time" type="TIMESTAMP" description="Timestamp when a user last updated this entry." />
    </table>
    <table name="site_type" description="Identifies a type of Site.  I.E.  StandAlone, Kiosk, Tent, etc.">
        <column name="id" type="VARCHAR" size="16" required="true" primaryKey="true" description="A unique key used to identify a Site Type" />
        <column name="name" type="VARCHAR" size="255" description="The name of the Site Type."
        <column name="create_time" type="TIMESTAMP" description="Timestamp when this entry was created." />
        <column name="create_by" type="VARCHAR" size="50" description="The user who last updated this entry." />
        <column name="last_update_by" type="VARCHAR" size="50" description="The user who created this entry." />
        <column name="last_update_time" type="TIMESTAMP" description="Timestamp when a user last updated this entry." />
    </table>       
    <table name="store" description="A retail outlet that sells merchandise and services through either a physical location, catalog, web page or other channel. It may or may not be identical to a Site. It may be co-located at the same Site as a DistributionCenter, InventoryLocation or AdministrativeCenter.">
        <column name="store_id" type="VARCHAR" size="16" required="true" primaryKey="true" description="A unique key used to identify a Retail Store" />
        <column name="open_date" type="TIMESTAMP" description="The opening date for the Retail Store" />
        <column name="close_date" type="TIMESTAMP" description="The opening date for the Retail Store" />
        <column name="create_time" type="TIMESTAMP" description="Timestamp when this entry was created." />
        <column name="create_by" type="VARCHAR" size="50" description="The user who last updated this entry." />
        <column name="last_update_by" type="VARCHAR" size="50" description="The user who created this entry." />
        <column name="last_update_time" type="TIMESTAMP" description="Timestamp when a user last updated this entry." />
    </table>   
    <table name="site" description="A geographical location at which the enterprise's business is conducted. Contains one or more of RetailStore, DistributionCenter, InventoryLocation and AdminstrativeCenter. A Site may include multiples Locations.">
        <column name="id" type="VARCHAR" size="16" required="true" primaryKey="true" description="A unique key used to identify a Retail Store" />
        <column name="site_type_id" type="VARCHAR" size="16" description="The type of site.  The corresponding Site Type id." />
        <column name="time_zone" type="VARCHAR" size="5" description="The time zone abbreviation this Site is located within."/>
        <column name="lattitude" type="VARCHAR" size="15" description="The geophysical latitude for the site."/>
        <column name="longitude" type="VARCHAR" size="15" description="The geophysical longitude for the site."/>
        <column name="address_id" type="VARCHAR" size="16" description="The corresponding Address where the Site resides." />
        <column name="phone_id" type="VARCHAR" size="16" description="The primary corresponding Phone for the Site." />
        <column name="email_id" type="VARCHAR" size="16" description="The primry corresponding Email for the Site." />      
        <column name="create_time" type="TIMESTAMP" description="Timestamp when this entry was created." />
        <column name="create_by" type="VARCHAR" size="50" description="The user who last updated this entry." />
        <column name="last_update_by" type="VARCHAR" size="50" description="The user who created this entry." />
        <column name="last_update_time" type="TIMESTAMP" description="Timestamp when a user last updated this entry." />
        <foreign-key foreignTable="site_type" name="fk_site_2_site_typ">
            <reference local="site_type_id" foreign="id" />
        </foreign-key>    
        <foreign-key foreignTable="address" name="fk_site_2_addr">
            <reference local="address_id" foreign="id" />
        </foreign-key>            
        <foreign-key foreignTable="phone" name="fk_site_2_phone">
            <reference local="phone_id" foreign="id" />
        </foreign-key>            
        <foreign-key foreignTable="email" name="fk_site_2_email">
            <reference local="email_id" foreign="id" />
        </foreign-key>            
    </table>
    <table name="store_site" description="A many to many relationship between logical Stores and physical Sites">
        <column name="store_id" type="VARCHAR" size="16" required="true" primaryKey="true" description="The corresponding Store id." />
        <column name="site_id" type="VARCHAR" size="16" required="true" primaryKey="true" description="The corresponding Site id." />
        <foreign-key foreignTable="store" name="fk_str_site_2_str">
            <reference local="store_id" foreign="id" />
        </foreign-key>            
        <foreign-key foreignTable="site" name="fk_str_site_2_site">
            <reference local="site_id" foreign="id" />
        </foreign-key>                    
    </table>
    <table name="address" description="A place or location designated by a postal authority for the delivery and pickup of mail.">
        <column name="id" type="VARCHAR" size="16" required="true" primaryKey="true" description="A unique key used to identify a Site Type" />
        <column name="line_1" type="VARCHAR" size="80" description="The first line of the address, normally the street number and name." />
        <column name="line_2" type="VARCHAR" size="80" description="The second line of an address, normally the Flat or Building Suite number." />
        <column name="line_3" type="VARCHAR" size="80" description="The third line of the Address." />
        <column name="line_4" type="VARCHAR" size="80" description="The fourth line of the Address." />
        <column name="city" type="VARCHAR" size="80" description="The city for the Address." />
        <column name="state_province" type="VARCHAR" size="80" description="The state/province for the Address." />
        <column name="postal_code" type="VARCHAR" size="80" description="The postal_code for the address." />
        <column name="country_id" type="VARCHAR" size="16" description="The corresponding Country for the Address." />        
        <column name="create_time" type="TIMESTAMP" description="Timestamp when this entry was created." />
        <column name="create_by" type="VARCHAR" size="50" description="The user who last updated this entry." />
        <column name="last_update_by" type="VARCHAR" size="50" description="The user who created this entry." />
        <column name="last_update_time" type="TIMESTAMP" description="Timestamp when a user last updated this entry." />
        <foreign-key foreignTable="country" name="fk_addr_2_cntry">
            <reference local="country_id" foreign="id" />
        </foreign-key>            
    </table>  
    <table name="phone" description="A telephone, cellular, pager, fax or other telecommunication device number.">
        <column name="id" type="VARCHAR" size="16" required="true" primaryKey="true" description="A unique key used to identify a Site Type" />
        <column name="country_dialing_code" type="VARCHAR" size="3" description="The dialing country code for the number." />
        <column name="area_code" type="VARCHAR" size="5" description="The 1 - 6 digit area code that further categorizes the Telephone with it's Country.." />
        <column name="number" type="VARCHAR" size="20" description="TThe 5 - 8 digit number for the Telephone within the confines of the ITUCountryCode and AreaCode." />
        <column name="extension" type="VARCHAR" size="5" description="Addtional numbers required to reach a Party's Telephone or voice mailbox.." />
        <column name="create_time" type="TIMESTAMP" description="Timestamp when this entry was created." />
        <column name="create_by" type="VARCHAR" size="50" description="The user who last updated this entry." />
        <column name="last_update_by" type="VARCHAR" size="50" description="The user who created this entry." />
        <column name="last_update_time" type="TIMESTAMP" description="Timestamp when a user last updated this entry." />
    </table>     
    <table name="email" description="An electronic mail address.">
        <column name="id" type="VARCHAR" size="16" required="true" primaryKey="true" description="A unique key used to identify an Email" />
        <column name="address" type="VARCHAR" size="255" description="The entire email address." />
        <column name="create_time" type="TIMESTAMP" description="Timestamp when this entry was created." />
        <column name="create_by" type="VARCHAR" size="50" description="The user who last updated this entry." />
        <column name="last_update_by" type="VARCHAR" size="50" description="The user who created this entry." />
        <column name="last_update_time" type="TIMESTAMP" description="Timestamp when a user last updated this entry." />
    </table>     
    <table name="country" description="A country in which an Address resides">
        <column name="id" type="VARCHAR" size="16" required="true" primaryKey="true" description="A unique key used to identify a Site Type." />
        <column name="country_code" TYPE="VARCHAR" size="30" required="true" description="The abbreviated code for the Country." />
        <column name="name" type="VARCHAR" size="255" description="The name of the Country." />
        <column name="create_time" type="TIMESTAMP" description="Timestamp when this entry was created." />
        <column name="create_by" type="VARCHAR" size="50" description="The user who last updated this entry." />
        <column name="last_update_by" type="VARCHAR" size="50" description="The user who created this entry." />
        <column name="last_update_time" type="TIMESTAMP" description="Timestamp when a user last updated this entry." />
    </table>       
    <table name="location" description="A physical place within the retailer conducts business. It may be any or all of the defined sub-types: WorkLocation, SellingLocation, InventoryLocation. As used in ARTS ODM location is intended to reflect non-moveable spaces within a Site (and a Site typically represents a building). A Fixture, is treated as a separate MOVABLE space that merchandise is stored and/or displayed on">
        <column name="id" type="VARCHAR" size="16" required="true" primaryKey="true" description="A unique key used to identify a Location" />
        <column name="brand_id" type="VARCHAR" size="16" description="The corresponding Brand for this Location."
        <!--  TODO: Determine if we want to add location hierarchy elements and if so, on Location or Site or Store -->
        <column name="create_time" type="TIMESTAMP" description="Timestamp when this entry was created." />
        <column name="create_by" type="VARCHAR" size="50" description="The user who last updated this entry." />
        <column name="last_update_by" type="VARCHAR" size="50" description="The user who created this entry." />
        <column name="last_update_time" type="TIMESTAMP" description="Timestamp when a user last updated this entry." />
        <foreign-key foreignTable="brand" name="fk_loc_2_brnd">
            <reference local="brand_id" foreign="id" />
        </foreign-key>                    
    </table> 
    <!-- Misc -->
    <table name="app_parameter">
        <column name="category" primaryKey="true" required="true" type="VARCHAR" size="20" />
        <column name="sub_category" primaryKey="true" required="true" type="VARCHAR" size="100" />
        <column name="name" primaryKey="true" required="true" type="VARCHAR" size="80" />
        <column name="level_id" primaryKey="true" required="true" type="VARCHAR" size="15" default="GLOBAL" />
        <column name="level_value" primaryKey="true" required="true" type="VARCHAR" size="20" />
        <column name="brand" primaryKey="true" required="true" type="VARCHAR" size="100" default="ANY" />
        <column name="order" primaryKey="true" required="true" type="NUMERIC" size="22" default="0" />
        <column name="value" type="VARCHAR" size="3800" />
        <column name="effective_time" primaryKey="true" required="true" type="TIMESTAMP" default="CURRENT_TIMESTAMP" />
        <column name="expiration_time" type="TIMESTAMP" />
        <column name="create_time" type="TIMESTAMP" description="Timestamp when this entry was created." />
        <column name="create_by" type="VARCHAR" size="50" description="The user who last updated this entry." />
        <column name="last_update_by" type="VARCHAR" size="50" description="The user who created this entry." />
        <column name="last_update_time" type="TIMESTAMP" description="Timestamp when a user last updated this entry." />
        <column name="min_version" type="VARCHAR" size="20" />
        <column name="max_version" type="VARCHAR" size="20" />
        <index name=idx_app_parameter">
            <index-column name="effective_time" />
            <index-column name="expiration_time" />
            <index-column name="level_id" />
            <index-column name="brand" />
        </index>
    </table>   
</database>