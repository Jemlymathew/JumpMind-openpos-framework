<div>
    <div *ngIf="showOptions">   
        <mat-nav-list>
            <mat-list-item *ngFor="let formOption of options; let i=index" (click)="formOption.enabled && onMakeOptionSelection(formOption, formGroups[i])">      
                <div gdColumns="auto 1fr auto" gdGap="6px" class="option">
                    <app-icon [ngClass]="{'muted-color' : !formOption.enabled}" color="primary" [iconName]="formOption.icon"></app-icon>
                    <span [ngClass]="{'muted-color' : !formOption.enabled}">{{formOption.name}}</span>
                    <mat-icon color="primary" class="material-icons" [ngClass]="{'muted-color' : !formOption.enabled}">keyboard_arrow_right</mat-icon>
                </div>
            </mat-list-item>
        </mat-nav-list>
    </div>
    <div *ngIf="!showOptions">
        <span>{{selectedOption.name}}</span>
        <ng-container *ngTemplateOutlet="form; context:{formGroup:selectedForm, option: selectedOption, showBackButton: true}"></ng-container>
    </div>
</div>

<ng-template #form let-option="option" let-formGroup="formGroup" let-showBackButton="showBackButton">
    <app-form (submitFormEvent)="onSubmitForm(option, formGroup)" [form]="formGroup">
        <app-dynamic-form-field *ngFor="let field of option.form.formElements" [formGroup]="formGroup" [formField]="field" (onFieldChanged)="onFieldChanged($event, formGroup, option)"></app-dynamic-form-field>
        <div gdAreas="back . submit" gdColumns="auto 1fr auto">
            <app-secondary-button *ngIf="showBackButton" gdArea="back" inputType="button" (buttonClick)="onBackButtonPressed()" class="back-button">
                <app-icon [iconName]="'keyboard_arrow_left'"></app-icon>
                <span>Back</span>
            </app-secondary-button>
            <app-primary-button gdArea="submit" inputType="submit" class="submit-button">
                <span>{{option.optionAction.title}}</span>
                <app-icon *ngIf="option.optionAction.icon" [iconName]="option.optionAction.icon"></app-icon>
            </app-primary-button>
        </div>
    </app-form>
</ng-template>